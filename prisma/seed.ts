import { PrismaClient, Role } from '@prisma/client';
import bcrypt from 'bcryptjs';

const prisma = new PrismaClient();

async function main() {
  console.log('Start seeding...');

  // Create admin user
  const hashedPassword = await bcrypt.hash('admin123', 10);
  
  const adminUser = await prisma.user.upsert({
    where: { email: 'admin@office.com' },
    update: {},
    create: {
      email: 'admin@office.com',
      name: 'Admin User',
      password: hashedPassword,
      role: Role.ADMIN,
    },
  });

  console.log('Created admin user:', adminUser);

  // Create regular user
  const userPassword = await bcrypt.hash('user123', 10);
  
  const regularUser = await prisma.user.upsert({
    where: { email: 'user@office.com' },
    update: {},
    create: {
      email: 'user@office.com',
      name: 'Regular User',
      password: userPassword,
      role: Role.USER,
    },
  });

  console.log('Created regular user:', regularUser);

  // Helper function to convert Buddhist Era date to Gregorian date
  function convertBuddhistToGregorian(buddhistDateStr: string): Date | null {
    if (!buddhistDateStr || buddhistDateStr === 'nan') return null;
    
    try {
      const date = new Date(buddhistDateStr);
      if (isNaN(date.getTime())) return null;
      
      // Convert Buddhist year to Gregorian year (subtract 543)
      const gregorianYear = date.getFullYear() - 543;
      return new Date(gregorianYear, date.getMonth(), date.getDate());
    } catch {
      return null;
    }
  }

  // Asset data from JSON
  const assetData = [
    {
      "ลำดับ": "61",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000015446#23",
      "รหัสครุภัณฑ์": "พม/สป-ศทส/06-02-22/023/2556",
      "ชื่อทรัพย์สิน": "ชุดไมโครโฟนพร้อมลำโพง Yamaha รุ่น PJP-20UR หมายเลขเครื่อง SPK043282",
      "ราคา": "16371",
      "ศูนย์ต้นทุน": "0600200006",
      "วันที่ลงบัญชี": "2556-09-06 00:00:00"
    },
    {
      "ลำดับ": "62",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000014626#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/13-01-03/001/2556",
      "ชื่อทรัพย์สิน": "เครื่องคอมพิวเตอร์ HP 1435 L จอ18.5",
      "ราคา": "31000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2556-05-03 00:00:00"
    },
    {
      "ลำดับ": "63",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000015052#134",
      "รหัสครุภัณฑ์": "พม/สป-ศทส/13-01-03/134/2556",
      "ชื่อทรัพย์สิน": "เครื่องคอมพิวเตอร์สำนักงานประมวลผลแบบที่ 2 พร้อมระบบปฏิบัติการ ยี่ห้อ acer รุ่น Veriton M2610G S/N UDVDKST591P32130206865",
      "ราคา": "36600",
      "ศูนย์ต้นทุน": "0600200006",
      "วันที่ลงบัญชี": "2556-07-01 00:00:00"
    },
    {
      "ลำดับ": "64",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000015051#133",
      "รหัสครุภัณฑ์": "พม/สป-ศทส/13-01-03/133/2556",
      "ชื่อทรัพย์สิน": "เครื่องคอมพิวเตอร์สำนักงานประมวลผลแบบที่ 2 พร้อมระบบปฏิบัติการ ยี่ห้อ acer รุ่น Veriton M2610G S/N UDVDKST591P32130206898",
      "ราคา": "36600",
      "ศูนย์ต้นทุน": "0600200006",
      "วันที่ลงบัญชี": "2556-07-01 00:00:00"
    },
    {
      "ลำดับ": "65",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#2",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "เครื่องสแกนเนอร์ ขนาด A4 ยี่ห้อ Cannon รุ่น LiDe 700F",
      "ราคา": "4000",
      "ศูนย์ต้นทุน": "0600200006",
      "วันที่ลงบัญชี": "2556-05-01 00:00:00"
    },
    {
      "ลำดับ": "66",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้เหล็กเก็บเอกสาร 2 ลิ้นชัก รุ่น DF-2A (พม/กพบ/04-01-02/001/2555)",
      "ราคา": "3050",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "2555-09-26 00:00:00"
    },
    {
      "ลำดับ": "67",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#2",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้เหล็กเก็บเอกสาร 4 ลิ้นชัก รุ่น DF-4 มอก. (พม/กพบ/04-01-04/002/2555)",
      "ราคา": "4950",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "2555-09-26 00:00:00"
    },
    {
      "ลำดับ": "68",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้เหล็กเก็บเอกสาร 4 ลิ้นชัก รุ่น DF-4 มอก. (พม/กพบ/04-01-04/001/2555)",
      "ราคา": "4950",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "2555-09-26 00:00:00"
    },
    {
      "ลำดับ": "69",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "nan",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้เหล็กเก็บเอกสาร 2 บาน เปิด รุ่น CD-01 มอก. (พม/กพบ/04-01-01/001/2555)",
      "ราคา": "4800",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "2555-09-26 00:00:00"
    },
    {
      "ลำดับ": "70",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#4",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "เก้าอี้พนักพิง รุ่น NP302 (หนังเทียม) (พม/กพบ/04-03-24/004/2555)",
      "ราคา": "2500",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "2555-09-26 00:00:00"
    },
    {
      "ลำดับ": "71",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#2",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "เก้าอี้พนักพิง รุ่น NP302 (หนังเทียม) (พม/กพบ/04-03-24/002/2555)",
      "ราคา": "2500",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "2555-09-26 00:00:00"
    },
    {
      "ลำดับ": "72",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้เหล็ก 3 ลิ้นชัก ขนาด 18x24x40 นิ้ว (สีเทา) (พม/กพบ/04-01-03/001/2550)",
      "ราคา": "2846",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "2550-06-25 00:00:00"
    },
    {
      "ลำดับ": "73",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#5",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้กระจกบานเลื่อน ขนาดกว้าง 1792 ลึก 406 สูง 876 มม.(สีเทา) (พม/กพบ/04-01-32/004/2551)",
      "ราคา": "4680",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "2551-06-06 00:00:00"
    },
    {
      "ลำดับ": "74",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#4",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้บานเลื่อนทึบ ขนาดกว้าง 1182 ลึก 406 สูง 876 มม.(สีเทา) (พม/กพบ/04-01-11/001/2551)",
      "ราคา": "3050",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "2551-06-06 00:00:00"
    },
    {
      "ลำดับ": "75",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้กระจกบานเลื่อน ขนาดกว้าง 1182 ลึก 406 สูง 876 มม.(สีเทา) มีฐานตู้ (พม/กพบ/04-01-32/001/2551)",
      "ราคา": "3650",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "2551-06-06 00:00:00"
    },
    {
      "ลำดับ": "76",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000012343#145",
      "รหัสครุภัณฑ์": "พม/สป-ศทส/13-01-03/145/2554",
      "ชื่อทรัพย์สิน": "เครื่องคอมพิวเตอร์สำหรับงานสำนักงาน ยี่ห้อ ACER",
      "ราคา": "18900",
      "ศูนย์ต้นทุน": "0600200006",
      "วันที่ลงบัญชี": "2554-06-16 00:00:00"
    },
    {
      "ลำดับ": "77",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000011564#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/05-01-04/001/2554",
      "ชื่อทรัพย์สิน": "รถยนต์ขับเคลื่อน 4 ล้อ ดับเบิ้ลแคป(ดีเซล)",
      "ราคา": "795000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2554-02-17 00:00:00"
    },
    {
      "ลำดับ": "78",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000010668#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/13-01-06/001/2554",
      "ชื่อทรัพย์สิน": "เครื่องปริ๊นเตอร์ ยี่ห้อ HP",
      "ราคา": "15563",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2554-01-31 00:00:00"
    },
    {
      "ลำดับ": "79",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000009994#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/05-01-03/001/2553",
      "ชื่อทรัพย์สิน": "รถยนต์ตู้",
      "ราคา": "1100000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2553-01-18 00:00:00"
    },
    {
      "ลำดับ": "80",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000009415#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/13-01-03/001/2552",
      "ชื่อทรัพย์สิน": "เครื่องคอมพิวเตอร์ PC ตั้งโต๊ะ",
      "ราคา": "20000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2552-09-08 00:00:00"
    },
    {
      "ลำดับ": "81",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000004732#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-01-08/001/2550",
      "ชื่อทรัพย์สิน": "ตู้ไม้ ขนาด 3.90x0.50x2.50 ม.",
      "ราคา": "41200",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2550-04-05 00:00:00"
    },
    {
      "ลำดับ": "82",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#2",
      "รหัสครุภัณฑ์": "พม/สป-สบก(กพอ)/04-02-03/002/2546",
      "ชื่อทรัพย์สิน": "โต๊ะทำงานระดับ 7",
      "ราคา": "4400",
      "ศูนย์ต้นทุน": "0600200003",
      "วันที่ลงบัญชี": "2549-10-25 00:00:00"
    },
    {
      "ลำดับ": "83",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#8",
      "รหัสครุภัณฑ์": "พม/สป-สตป/04-02-12/008/2546",
      "ชื่อทรัพย์สิน": "โต๊ะวางเครื่องคอมพิวเตอร์",
      "ราคา": "850",
      "ศูนย์ต้นทุน": "0600200010",
      "วันที่ลงบัญชี": "2546-07-30 00:00:00"
    },
    {
      "ลำดับ": "84",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#17",
      "รหัสครุภัณฑ์": "พม/สป-สตป/04-02-02/017/2546",
      "ชื่อทรัพย์สิน": "โต๊ะทำงานระดับ 3-6",
      "ราคา": "2600",
      "ศูนย์ต้นทุน": "0600200010",
      "วันที่ลงบัญชี": "2546-06-20 00:00:00"
    },
    {
      "ลำดับ": "85",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#4",
      "รหัสครุภัณฑ์": "พม/กพบ/04-03-23/004/2547",
      "ชื่อทรัพย์สิน": "เก้าอี้เอนกประสงค์",
      "ราคา": "560",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "86",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#3",
      "รหัสครุภัณฑ์": "พม/กพบ/04-03-23/003/2547",
      "ชื่อทรัพย์สิน": "เก้าอี้เอนกประสงค์",
      "ราคา": "560",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "87",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#2",
      "รหัสครุภัณฑ์": "พม/กพบ/04-03-23/002/2547",
      "ชื่อทรัพย์สิน": "เก้าอี้เอนกประสงค์",
      "ราคา": "560",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "88",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "พม/กพบ/04-03-23/001/2547",
      "ชื่อทรัพย์สิน": "เก้าอี้เอนกประสงค์",
      "ราคา": "560",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "89",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#4",
      "รหัสครุภัณฑ์": "พม/กพบ/04-02-03/004/2546",
      "ชื่อทรัพย์สิน": "โต๊ะทำงานระดับ 7",
      "ราคา": "4400",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "90",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#3",
      "รหัสครุภัณฑ์": "พม/กพบ/04-02-03/003/2546",
      "ชื่อทรัพย์สิน": "โต๊ะทำงานระดับ 7",
      "ราคา": "4400",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "91",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#2",
      "รหัสครุภัณฑ์": "พม/กพบ/04-02-03/002/2546",
      "ชื่อทรัพย์สิน": "โต๊ะทำงานระดับ 7",
      "ราคา": "4400",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "92",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#5",
      "รหัสครุภัณฑ์": "พม/กพบ/04-02-02/005/2546",
      "ชื่อทรัพย์สิน": "โต๊ะทำงานระดับ 3-6",
      "ราคา": "2600",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "93",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#2",
      "รหัสครุภัณฑ์": "พม/กพบ/04-01-04/002/2548",
      "ชื่อทรัพย์สิน": "ตู้เหล็ก 4 ลิ้นชัก",
      "ราคา": "2500",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "94",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#2",
      "รหัสครุภัณฑ์": "พม/กพบ/04-01-03/002/2547",
      "ชื่อทรัพย์สิน": "ตู้เหล็ก 3 ลิ้นชัก",
      "ราคา": "2500",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "95",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#5",
      "รหัสครุภัณฑ์": "พม/กพบ/04-01-02/005/2547",
      "ชื่อทรัพย์สิน": "ตู้เหล็ก 2 ลิ้นชัก",
      "ราคา": "2100",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "96",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#2",
      "รหัสครุภัณฑ์": "พม/กพบ/04-01-02/002/2546",
      "ชื่อทรัพย์สิน": "ตู้เหล็กขนาด 2 ลิ้นชัก",
      "ราคา": "1449",
      "ศูนย์ต้นทุน": "0600200002",
      "วันที่ลงบัญชี": "2546-08-08 00:00:00"
    },
    {
      "ลำดับ": "97",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "nan",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "เก้าอี้บุหนัง-แก๊ส Euro-J600L บ.ยูโรแปลน",
      "ราคา": "3528",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2552-09-08 00:00:00"
    },
    {
      "ลำดับ": "98",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "nan",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้เตี้ยชั้นโล่ง MCL-800 สีเชอรี่ดำ บ.ชัวร์",
      "ราคา": "2780",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2552-09-08 00:00:00"
    },
    {
      "ลำดับ": "99",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "nan",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้เตี้ย 2 บานเปิด MCL-810 สีเชอรี่ดำ บ.ชัวร์",
      "ราคา": "3700",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2552-09-08 00:00:00"
    },
    {
      "ลำดับ": "100",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "nan",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้เตี้ย 2 บานเปิด MCL-810 สีเชอรี่ดำ บ.ชัวร์",
      "ราคา": "3700",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2552-09-08 00:00:00"
    },
    {
      "ลำดับ": "101",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "nan",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "เครื่องขยายเสียง",
      "ราคา": "4000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2546-10-01 00:00:00"
    },
    {
      "ลำดับ": "102",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ขาไมโครโฟนตั้งโต๊ะ",
      "ราคา": "300",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2546-10-01 00:00:00"
    },
    {
      "ลำดับ": "103",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ลำโพง",
      "ราคา": "3300",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2546-10-01 00:00:00"
    },
    {
      "ลำดับ": "104",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "โต๊ะวางโทรศัพท์ มีชั้นเก็บของ",
      "ราคา": "2000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2546-10-01 00:00:00"
    },
    {
      "ลำดับ": "105",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "nan",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้เหล็ก 15 ลิ้นชัก",
      "ราคา": "2600",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2546-10-01 00:00:00"
    },
    {
      "ลำดับ": "106",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "nan",
      "ชื่อทรัพย์สิน": "ตู้เหล็ก 15 ลิ้นชัก",
      "ราคา": "2600",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2546-10-01 00:00:00"
    },
    {
      "ลำดับ": "107",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000002820#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-09-12/001/2548",
      "ชื่อทรัพย์สิน": "บอร์ดประชาสัมพันธ์",
      "ราคา": "20000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "108",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#11",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/13-01-19/011/2548",
      "ชื่อทรัพย์สิน": "สแกนเนอร์",
      "ราคา": "2000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "109",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000004710#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/07-02-11/001/2550",
      "ชื่อทรัพย์สิน": "เครื่องมัลติมิเดียโปรเจคเตอร์ ระดับ XGA ขนาด 2500 ANSI Lumens",
      "ราคา": "93000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2549-11-03 00:00:00"
    },
    {
      "ลำดับ": "110",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000004709#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/07-02-07/001/2550",
      "ชื่อทรัพย์สิน": "จอรับภาพ ชนิดมือดึง ขนาดเส้นทะแยงมุม 120 นิ้ว",
      "ราคา": "9400",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2549-11-03 00:00:00"
    },
    {
      "ลำดับ": "111",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/07-02-07/001/2538",
      "ชื่อทรัพย์สิน": "จอรับภาพ 125x125 ซม.",
      "ราคา": "1800",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "112",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000004726#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/07-02-04/001/2550",
      "ชื่อทรัพย์สิน": "เครื่องฉายภาพทึบแสง 3 มิติ",
      "ราคา": "54000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2550-04-19 00:00:00"
    },
    {
      "ลำดับ": "113",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/05-02-02/001/2540",
      "ชื่อทรัพย์สิน": "เรืออลูมิเนียม 16 ฟุต สีขาว 40 แรงม้า",
      "ราคา": "0",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "114",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000008331#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/05-01-07/001/2552",
      "ชื่อทรัพย์สิน": "รถจักรยานยนต์ ยี่ห้อ HONDA DREAM 125 CC",
      "ราคา": "40000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2552-01-21 00:00:00"
    },
    {
      "ลำดับ": "115",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000006592#2",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/05-01-03/001/2550",
      "ชื่อทรัพย์สิน": "รถยนต์โดยสาร ปริมาตรกระบอกสูบ 2,953 ซีซี (นข 3521 พล)",
      "ราคา": "993452.04",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2550-10-01 00:00:00"
    },
    {
      "ลำดับ": "116",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000006742#8",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-07-02/008/2551",
      "ชื่อทรัพย์สิน": "เครื่องปรับอากาศ ขนาด 44,000 บีทียู",
      "ราคา": "51000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2551-01-30 00:00:00"
    },
    {
      "ลำดับ": "117",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000006741#7",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-07-02/007/2551",
      "ชื่อทรัพย์สิน": "เครื่องปรับอากาศ ขนาด 44,000 บีทียู",
      "ราคา": "51000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2551-01-30 00:00:00"
    },
    {
      "ลำดับ": "118",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000006740#6",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-07-02/006/2551",
      "ชื่อทรัพย์สิน": "เครื่องปรับอากาศ ขนาด 44,000 บีทียู",
      "ราคา": "51000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2551-01-30 00:00:00"
    },
    {
      "ลำดับ": "119",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000006739#5",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-07-02/005/2551",
      "ชื่อทรัพย์สิน": "เครื่องปรับอากาศ ขนาด 44,000 บีทียู",
      "ราคา": "51000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2551-01-30 00:00:00"
    },
    {
      "ลำดับ": "120",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000006738#4",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-07-02/004/2551",
      "ชื่อทรัพย์สิน": "เครื่องปรับอากาศ ขนาด 44,000 บีทียู",
      "ราคา": "51000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2551-01-30 00:00:00"
    },
    {
      "ลำดับ": "121",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000006737#3",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-07-02/003/2551",
      "ชื่อทรัพย์สิน": "เครื่องปรับอากาศ ขนาด 44,000 บีทียู",
      "ราคา": "51000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2551-01-30 00:00:00"
    },
    {
      "ลำดับ": "122",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000006736#2",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-07-02/002/2551",
      "ชื่อทรัพย์สิน": "เครื่องปรับอากาศ ขนาด 18,000 บีทียู",
      "ราคา": "26000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2551-01-30 00:00:00"
    },
    {
      "ลำดับ": "123",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "100000006735#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-07-02/001/2551",
      "ชื่อทรัพย์สิน": "เครื่องปรับอากาศ ขนาด 18,000 บีทียู",
      "ราคา": "26000",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "2551-01-30 00:00:00"
    },
    {
      "ลำดับ": "124",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#4",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-04-01/004/2537",
      "ชื่อทรัพย์สิน": "เครื่องพิมพ์ดีดแบบธรรมดาตั้งโต๊ะ",
      "ราคา": "8590",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "nan"
    },
    {
      "ลำดับ": "125",
      "รหัสสินทรัพย์(GFMIS)#S. No.": "#1",
      "รหัสครุภัณฑ์": "พม/พมจ-พล/04-04-01/001/2538",
      "ชื่อทรัพย์สิน": "เครื่องพิมพ์ดีดแบบธรรมดาตั้งโต๊ะ",
      "ราคา": "8600",
      "ศูนย์ต้นทุน": "0600200064",
      "วันที่ลงบัญชี": "nan"
    }
  ];

  // Function to categorize assets based on name
  function categorizeAsset(name: string): string {
    const lowerName = name.toLowerCase();
    if (lowerName.includes('คอมพิวเตอร์') || lowerName.includes('computer')) return 'คอมพิวเตอร์';
    if (lowerName.includes('ไมโครโฟน') || lowerName.includes('microphone') || lowerName.includes('ลำโพง')) return 'อุปกรณ์เสียง';
    if (lowerName.includes('ตู้') || lowerName.includes('cabinet')) return 'เฟอร์นิเจอร์';
    if (lowerName.includes('เก้าอี้') || lowerName.includes('chair')) return 'เฟอร์นิเจอร์';
    if (lowerName.includes('โต๊ะ') || lowerName.includes('table') || lowerName.includes('desk')) return 'เฟอร์นิเจอร์';
    if (lowerName.includes('รถ') || lowerName.includes('vehicle')) return 'ยานพาหนะ';
    if (lowerName.includes('เครื่องปรับอากาศ') || lowerName.includes('air')) return 'เครื่องใช้ไฟฟ้า';
    if (lowerName.includes('สแกน') || lowerName.includes('scanner')) return 'อุปกรณ์สำนักงาน';
    if (lowerName.includes('ปริ๊น') || lowerName.includes('printer')) return 'อุปกรณ์สำนักงาน';
    if (lowerName.includes('โปรเจค') || lowerName.includes('projector')) return 'อุปกรณ์นำเสนอ';
    if (lowerName.includes('จอ') || lowerName.includes('screen')) return 'อุปกรณ์นำเสนอ';
    return 'อื่นๆ';
  }

  // Function to determine location based on cost center
  function determineLocation(costCenter: string): string {
    if (costCenter === '0600200006') return 'สำนักงานข้อมูลสารสนเทศ';
    if (costCenter === '0600200064') return 'สำนักงานพัฒนาจังหวัดพะเยา';
    if (costCenter === '0600200002') return 'สำนักงานกลุ่มงานบริหาร';
    if (costCenter === '0600200010') return 'สำนักงานแผนงานโครงการ';
    if (costCenter === '0600200003') return 'สำนักงานกิจการพิเศษ';
    return 'สำนักงานทั่วไป';
  }

  // Create assets from JSON data
  console.log('Creating assets from JSON data...');
  
  // Check if assets already exist
  const existingAssetCount = await prisma.asset.count();
  if (existingAssetCount >= 65) {
    console.log(`Assets already exist (${existingAssetCount}). Skipping JSON data import.`);
  } else {
    let createdCount = 0;
    
    for (const item of assetData) {
      try {
        const assetCode = item['รหัสครุภัณฑ์'] && item['รหัสครุภัณฑ์'] !== 'nan' ? item['รหัสครุภัณฑ์'] : null;
        const gfmisCode = item['รหัสสินทรัพย์(GFMIS)#S. No.'] && !item['รหัสสินทรัพย์(GFMIS)#S. No.'].startsWith('#') && item['รหัสสินทรัพย์(GFMIS)#S. No.'] !== 'nan' 
          ? item['รหัสสินทรัพย์(GFMIS)#S. No.'] 
          : `ASSET-${item['ลำดับ']}-SEED`;

        const price = parseFloat(item['ราคา']) || 0;
        const accountingDate = convertBuddhistToGregorian(item['วันที่ลงบัญชี']);
        
        await prisma.asset.upsert({
          where: { code: gfmisCode },
          update: {},
          create: {
            code: gfmisCode,
            name: item['ชื่อทรัพย์สิน'],
            assetCode: assetCode,
            category: categorizeAsset(item['ชื่อทรัพย์สิน']),
            location: determineLocation(item['ศูนย์ต้นทุน']),
            costCenter: item['ศูนย์ต้นทุน'],
            price: price,
            accountingDate: accountingDate,
            status: 'AVAILABLE',
          },
        });
        
        createdCount++;
        
        if (createdCount % 10 === 0) {
          console.log(`Created ${createdCount} assets...`);
        }
      } catch (error) {
        console.error(`Error creating asset ${item['ลำดับ']}:`, error);
      }
    }
    console.log(`Created ${createdCount} assets from JSON data`);
  }

  // Create sample assets for testing
  const sampleAssets = await Promise.all([
    prisma.asset.upsert({
      where: { code: 'NB001' },
      update: {},
      create: {
        code: 'NB001',
        name: 'Notebook Laptop Dell Inspiron',
        description: 'Laptop Dell Inspiron 15 3000 Series',
        category: 'คอมพิวเตอร์',
        location: 'ห้องทำงาน',
        status: 'AVAILABLE',
        imageUrl: '/images/laptop.jpg',
      },
    }),
    prisma.asset.upsert({
      where: { code: 'PRJ001' },
      update: {},
      create: {
        code: 'PRJ001',
        name: 'Projector Epson EB-S41',
        description: 'โปรเจ็คเตอร์ Epson EB-S41 3300 ANSI Lumens',
        category: 'อุปกรณ์นำเสนอ',
        location: 'ห้องประชุม',
        status: 'AVAILABLE',
        imageUrl: '/images/projector.jpg',
      },
    }),
    prisma.asset.upsert({
      where: { code: 'MIC001' },
      update: {},
      create: {
        code: 'MIC001',
        name: 'Microphone Wireless',
        description: 'ไมโครโฟนไร้สาย แบบมือถือ',
        category: 'อุปกรณ์เสียง',
        location: 'ห้องประชุม',
        status: 'DAMAGED',
        imageUrl: '/images/microphone.jpg',
      },
    }),
    prisma.asset.upsert({
      where: { code: 'CAM001' },
      update: {},
      create: {
        code: 'CAM001',
        name: 'Digital Camera Canon EOS',
        description: 'กล้องดิจิทัล Canon EOS 1500D',
        category: 'อุปกรณ์ถ่ายภาพ',
        location: 'ห้องสื่อ',
        status: 'OUT_OF_STOCK',
        imageUrl: '/images/camera.jpg',
      },
    }),
    prisma.asset.upsert({
      where: { code: 'TAB001' },
      update: {},
      create: {
        code: 'TAB001',
        name: 'Tablet iPad Air',
        description: 'Tablet iPad Air 10.9 inch',
        category: 'แท็บเล็ต',
        location: 'ห้องทำงาน',
        status: 'AVAILABLE',
        imageUrl: '/images/tablet.jpg',
      },
    }),
  ]);

  console.log('Created sample assets:', sampleAssets.length);

  console.log('Seeding finished.');
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
